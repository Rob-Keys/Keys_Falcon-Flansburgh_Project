---
title: "Keys_Falcon_Flansburgh_RMD"
output: html_document
date: "2024-07-10"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:
```{r}
# Libraries
library(readr)
library(dplyr)
library(ggplot2)

library(tidyverse)
```

```{r}
# Data import
originalData <- read_csv('Data_Sheet_1_Comparing Mental Health of Athletes and Non-athletes as They Emerge From a COVID-19 Pandemic Lockdown.csv')
head(originalData)
```



```{r}
# Data cleanup
Data <- originalData %>% filter(originalData$`Emotional Wellbeing` < 999)
head(Data)

```

```{r}
# MLR, Emotional Wellbeing as response variable, I consider myself an athlete, most of my friends are athletes, and Sport is the most important part of my life as predictors
Emo_Data <- Data %>% select(`Emotional Wellbeing`, `I consider myself an athlete`, `most of my friends are athletes`, `Sport is the most important part of my life`)
Emo_Data <- Emo_Data %>% filter(`I consider myself an athlete` < 999)
Emo_Well_Fit <- lm(Emo_Data$`Emotional Wellbeing` ~ Emo_Data$`I consider myself an athlete` + Emo_Data$`most of my friends are athletes` + Emo_Data$`Sport is the most important part of my life`)
summary(Emo_Well_Fit)
#install.packages("car")
library(car)
avPlots(Emo_Well_Fit)

```
```{r}
# Emotional Wellbeing as a function of Weeks Social Distancing 

ggplot(Data, aes(x=Data$`Weeks Social Distancing`, y=Data$`Emotional Wellbeing`, color=factor(Data$`Athlete/Non-Athlete`)))+
geom_point()+
geom_smooth(method=lm, se=FALSE)

Emo_Weeks_Fit <- lm(Data$`Emotional Wellbeing` ~ Data$`Weeks Social Distancing`*as.factor(Data$`Athlete/Non-Athlete`), data = Data)
summary(Emo_Weeks_Fit)
```
```{r}
# MLR with "MHC-SF" as the variable were predicting, and every athletic-related variable as predictors
ai <- originalData %>% select(`MHC-SF OVERALL`,`AIMS_ TOTAL`,`I consider myself an athlete`,`I have many goals related to sport`,`most of my friends are athletes`,`Sport is the most important part of my life`,`I spend more time thinking about sport than anything else`,`I feel bad about myself when I do badly in sport`,`I would be very depressed if I were injured and could not compete in sport`)
ai <- ai %>% filter(`AIMS_ TOTAL` <= 100, `MHC-SF OVERALL` <= 100,`I consider myself an athlete`<= 100,`I have many goals related to sport`<= 100,`most of my friends are athletes`<= 100,`Sport is the most important part of my life`<= 100,`I spend more time thinking about sport than anything else`<= 100,`I feel bad about myself when I do badly in sport`<= 100,`I would be very depressed if I were injured and could not compete in sport`<= 100)

fit <- glm(ai$`MHC-SF OVERALL` ~ ai$`AIMS_ TOTAL`+ai$`I consider myself an athlete`+ai$`I have many goals related to sport`+ai$`most of my friends are athletes`+ai$`Sport is the most important part of my life`+ai$`I spend more time thinking about sport than anything else`+ai$`I feel bad about myself when I do badly in sport`+ai$`I would be very depressed if I were injured and could not compete in sport`, data = ai)
summary(fit)
pairs(ai,lower.panel=NULL,)
```

```{r warning=FALSE}
# Clean the data of columns with a lot of missing data or unusable data, then remove all rows with a missing value
cleanData = originalData[c(2,3,4,7,8,9,10,12,14:27,34:84)]
for(i in 1:73){
  cleanData = cleanData %>% filter(cleanData[i] < 100)
}
train <- sample(1:nrow(cleanData), nrow(cleanData)*0.75)
training = cleanData[train,]
testing = cleanData[-train,]
```

```{r warning=FALSE}
library(tree)
tree_model <- tree(cleanData$`Emotional Wellbeing` ~ cleanData$`Gender:` + cleanData$`Age Group:` + cleanData$`Country During Lockdown` + cleanData$`Marital Status:` + cleanData$`Smoking Status:` + cleanData$`Five Fruit and Veg` + cleanData$`Hours sleep:` + cleanData$`Shielded?` + cleanData$`Weeks Social Distancing` + cleanData$`# in lockdown bubble:` + cleanData$`Athlete/Non-Athlete` + cleanData$`AIMS_ TOTAL` + cleanData$`Social Identity` + cleanData$`I consider myself an athlete` + cleanData$`I have many goals related to sport` + cleanData$`most of my friends are athletes` + cleanData$`Exclusivity` + cleanData$`Sport is the most important part of my life` + cleanData$`I spend more time thinking about sport than anything else` + cleanData$`Negative Affectivity` + cleanData$`I feel bad about myself when I do badly in sport` + cleanData$`I would be very depressed if I were injured and could not compete in sport` + cleanData$`MHC-SF OVERALL` + cleanData$`Happy` + cleanData$`Interested in life` + cleanData$`Satisfied` + cleanData$`Social Wellbeing` + cleanData$`That you had something important to contribute to society` + cleanData$`That you belonged to a community (like a social group or your neighbourhood)` + cleanData$`That our society is becoming a better place for people like you` + cleanData$`That people are basically good` + cleanData$`That the way our society works makes sense to you` + cleanData$`Psychological Wellbeing` + cleanData$`That you liked most parts of your personality` + cleanData$`Good at managing the responsibilities of your daily life` + cleanData$`That you had warm and trusting relationships with others` + cleanData$`That you had experiences that challenged you to grow and become a better person` + cleanData$`Confident to think or express your own ideas and opinions` + cleanData$`That your life has a sense of direction or meaning to it` + cleanData$`HADS OVERALL` + cleanData$`HADS-A AVERAGE` + cleanData$`HADS-D AVERAGE` + cleanData$`I feel tense or 'wound up':` + cleanData$`I still enjoy the things I used to enjoy:` + cleanData$`I get a sort of frightened feeling as if something awful is about to happen:` + cleanData$`I can laugh and see the funny side of things:` + cleanData$`Worrying thoughts go through my mind:` + cleanData$`I feel cheerful:` + cleanData$`I can sit at ease and feel relaxed:` + cleanData$`I feel as if I am slowed down:` + cleanData$`I get a sort of frightened feeling like 'butterflies' in my stomach:` + cleanData$`I have lost interest in my appearance:` + cleanData$`I feel restless as I have to be on the move:` + cleanData$`I look forward with enjoyment to things:` + cleanData$`I get sudden feelings of panic:` + cleanData$`I can enjoy a good book or radio or TV programme:` + cleanData$`RES_TOTAL` + cleanData$`I tend to bounce back quickly after hard times` + cleanData$`I have a hard time making it through stressful events*` + cleanData$`It does not take me long to recover from a stressful event` + cleanData$`It is hard for me to snap back when something bad happens*` + cleanData$`I usually come through difficult times with little trouble` + cleanData$`I tend to take a long time to get over setbacks in my life*` + cleanData$`LONE_ TOTAL` + cleanData$`LONE_ Emotional` + cleanData$`LONE_ Social` + cleanData$`I experience a general sense of emptiness` + cleanData$`I miss having people around` + cleanData$`There are many people I can trust completely*` + cleanData$`I often feel rejected` + cleanData$`There are enough people I feel close to*` + cleanData$`There are plenty of people I can rely on when I have problems*`, data = training)
plot(tree_model)
text(tree_model,pretty=0,cex=0.7)
summary(tree_model)
```

```{r warning=FALSE}
specific_tree_model <- tree(cleanData$`Emotional Wellbeing` ~ cleanData$`Gender:` + cleanData$`Age Group:` + cleanData$`Country During Lockdown` + cleanData$`Marital Status:` + cleanData$`Smoking Status:` + cleanData$`Five Fruit and Veg` + cleanData$`Hours sleep:` + cleanData$`Shielded?` + cleanData$`Weeks Social Distancing` + cleanData$`# in lockdown bubble:` + cleanData$`Athlete/Non-Athlete` + cleanData$`AIMS_ TOTAL` + cleanData$`Social Identity` + cleanData$`I consider myself an athlete` + cleanData$`I have many goals related to sport` + cleanData$`most of my friends are athletes` + cleanData$`Exclusivity` + cleanData$`Sport is the most important part of my life` + cleanData$`I spend more time thinking about sport than anything else` + cleanData$`Negative Affectivity` + cleanData$`I feel bad about myself when I do badly in sport` + cleanData$`I would be very depressed if I were injured and could not compete in sport` + cleanData$`RES_TOTAL` + cleanData$`I tend to bounce back quickly after hard times` + cleanData$`I have a hard time making it through stressful events*` + cleanData$`It does not take me long to recover from a stressful event` + cleanData$`It is hard for me to snap back when something bad happens*` + cleanData$`I usually come through difficult times with little trouble` + cleanData$`I tend to take a long time to get over setbacks in my life*` + cleanData$`I miss having people around` + cleanData$`There are many people I can trust completely*` + cleanData$`There are enough people I feel close to*` + cleanData$`There are plenty of people I can rely on when I have problems*`, data = training)
plot(specific_tree_model)
text(specific_tree_model,pretty=0,cex=0.7)
summary(specific_tree_model)
```


```{r warning=FALSE}
#cross-validation of the above tree
cv.specific <- cv.tree(specific_tree_model)
cv.specific
plot(cv.specific$size,cv.specific$dev,type='b')
```


```{r warning=FALSE}
#pruning the above tree

prune.specific <- prune.tree(specific_tree_model, best = 6)
plot(prune.specific)
text(prune.specific,pretty=0)

#getting mse for pruned tree
prediction <- round(predict(prune.specific, newdata = testing))
mse <- mean((testing$`Emotional Wellbeing` - prediction)^2)
print("Testing mse of pruned tree")
mse
```

```{r warning=FALSE}
#this tree only uses predictors that are related to sports and athletics
morespecific_tree_model <- tree(cleanData$`Emotional Wellbeing` ~ cleanData$`Athlete/Non-Athlete` + cleanData$`AIMS_ TOTAL` + cleanData$`I consider myself an athlete` + cleanData$`I have many goals related to sport` + cleanData$`most of my friends are athletes` + cleanData$`Sport is the most important part of my life` + cleanData$`I spend more time thinking about sport than anything else` + cleanData$`I feel bad about myself when I do badly in sport` + cleanData$`I would be very depressed if I were injured and could not compete in sport`, data = training)
plot(morespecific_tree_model)
text(morespecific_tree_model,pretty=0,cex=0.7)
summary(morespecific_tree_model)

#getting mean square error rate
prediction = round(predict(morespecific_tree_model, newdata = testing))
mse <- mean((testing$`Emotional Wellbeing` - prediction)^2)
print("Testing mse of non-pruned tree")
mse
```



```{r warning=FALSE}
#finding optimal tree size
cv.tree(morespecific_tree_model)
tree_size = c(6,5,4,3,1)
optimalSize=c()
for(i in 1:100){
  optimalSize = c(optimalSize,tree_size[which.min(cv.tree(morespecific_tree_model)$dev)])
}
table(optimalSize)

#creating pruned tree
newtree=prune.tree(morespecific_tree_model,best=5)
plot(newtree)
text(newtree,pretty=0,cex=0.7)
summary(newtree)

#getting mse for pruned tree
prediction = round(predict(newtree, newdata = testing))
mse <- mean((testing$`Emotional Wellbeing` - prediction)^2)
print("Testing mse of pruned tree")
mse

#creating extra pruned tree
manualTree=prune.tree(morespecific_tree_model,best=3)
plot(manualTree)
text(manualTree,pretty=0,cex=0.7)
summary(manualTree)

#getting mse for pruned tree
prediction = round(predict(manualTree, newdata = testing))
mse <- mean((testing$`Emotional Wellbeing` - prediction)^2)
print("Testing mse of manually pruned tree")
mse
```

```{r warning=FALSE}
#ANOVA Comparison between the mean well being of non athletes and the mean well being of athletes
aov_results <- aov(cleanData$`Emotional Wellbeing` ~ factor(cleanData$`Athlete/Non-Athlete`))
summary(aov_results)
```


```{r warning=FALSE}
#ANOVA Comparison between the mean resliency of non athletes and the mean well being of athletes
aov_results <- aov(cleanData$`RES_TOTAL` ~ factor(cleanData$`Athlete/Non-Athlete`))
summary(aov_results)
```